<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Video Naming Block System</title>
  <style>
    .brick-list {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 8px;
    }
    .brick {
      background: #e0e0e0;
      padding: 5px 10px;
      border-radius: 6px;
      display: flex;
      align-items: center;
    }
    .edit-icon {
      margin-left: 4px;
      cursor: pointer;
      color: gray;
    }
    .del-btn {
      margin-left: 4px;
      background: #ff6666;
      color: white;
      border: none;
      border-radius: 3px;
      padding: 2px 6px;
      cursor: pointer;
    }
    .template-preview {
      border: 1px solid #ccc;
      background: #f0f4f8;
      padding: 10px;
      margin-top: 10px;
    }
  </style>
</head>
<body>
  <h2>1. Upload 9:16 Video</h2>
  <form id="mainForm" method="post" enctype="multipart/form-data" action="/convert">
    <input type="file" name="video" required><br><br>

    <h2>2. Select Output Sizes</h2>
    <label><input type="checkbox" name="selected_sizes[]" value="916" checked> 9:16</label>
    <label><input type="checkbox" name="selected_sizes[]" value="11" checked> 1:1</label>
    <label><input type="checkbox" name="selected_sizes[]" value="169" checked> 16:9</label>
    <label><input type="checkbox" name="selected_sizes[]" value="23" checked> 2:3</label>
    <label><input type="checkbox" name="selected_sizes[]" value="45" checked> 4:5</label>

    <h2>3. Configure Naming Blocks <span class="note">(Click the ✎ icon to edit blocks)</span></h2>

    <button type="button" id="addFixed">Add Fixed Name Block</button>
    <button type="button" id="addSize">Add Size Block (default)</button>
    <button type="button" id="addCustom">Add Custom Name Block</button>
    <button type="button" id="showPreset">Add Common Fixed Blocks</button>

    <div id="brickArea" class="brick-list"></div>

    <!-- Blue Template Preview -->
    <div id="templatePreviewArea" style="display:none; border:1px solid #ccc; padding:8px; background:#f2f2f2; margin-top:10px;">
      <div id="templatePreviewTitle" style="font-weight:bold; margin-bottom:6px;">Template Preview:</div>
      <div id="templatePreviewBricks" class="brick-list"></div>
    </div>

    <!-- Save as Template -->
    <div style="margin-top:10px;">
      Save as Template: <input type="text" id="templateSaveName" placeholder="e.g. Default Combo">
      <button type="button" id="saveTemplateBtn">Save</button>
    </div>

    <!-- Custom Name Editor -->
    <div id="customNameArea" style="display: none; margin-top: 10px;">
      <h3>Set Custom Names for Each Size:</h3>
      <div id="customInputs"></div>
      <input type="hidden" name="mode" id="mode" value="">
      <div style="margin-top:10px;">
        Preset Name:
        <input type="text" id="customPresetName" placeholder="e.g. English Sizes">
        <button type="button" id="saveCustomPreset">Save</button>
        <button type="button" id="cancelCustomPreset">Cancel</button>
      </div>
    </div>

    <h2>4. Customize <span class="edit-icon" id="toggleEditMode">✎</span></h2>
    <div id="customPresetModule">
      <div>
        <b style="color: steelblue;">Templates:</b>
        <div id="templateList" class="brick-list"></div>
        <div id="templateDetailPanel" class="template-preview" style="display: none;">
          <div id="templateDetailTitle" style="font-weight:bold; margin-bottom:8px;">Template Details:</div>
          <div id="templateDetailBricks" class="brick-list"></div>
          <div id="templateEditControls" style="display: none; margin-top: 8px;">
            <button type="button" id="saveTemplateEdit">Save</button>
            <button type="button" id="cancelTemplateEdit">Cancel</button>
          </div>
        </div>
      </div>

      <div style="margin-top:10px;">
        <b style="color: orange;">Common Fixed Blocks:</b>
        <div id="customFixedList" class="brick-list"></div>
      </div>
      <div style="margin-top:10px;">
        <b style="color: seagreen;">Custom Name Presets:</b>
        <div id="customNamedList" class="brick-list"></div>
        <div id="customDetailPanel" style="display:none; border: 1px solid #ccc; padding: 10px; background: #f7f7f7;">
          <div id="customDetailTitle" style="font-weight: bold; margin-bottom: 10px;">Custom Name Details:</div>
          <div id="customDetailInputs"></div>
          <button type="button" id="saveCustomDetail" style="background: seagreen; color: white; margin-top: 8px;">Save</button>
          <button type="button" id="cancelCustomDetail" style="margin-left: 8px;">Cancel</button>
        </div>
      </div>

      <div id="editControlButtons" style="display: none; margin-top: 8px;">
        <button type="button" id="saveCustomEdits">Save</button>
        <button type="button" id="cancelCustomEdits">Cancel</button>
      </div>
    </div>

    <h2>5. Set ZIP File Name</h2>
    <input type="text" name="zipname" placeholder="e.g. SSD_10086S01" style="width: 300px;" required>
    <input type="hidden" id="blockStorage" name="blocks">

    <div class="section" style="margin-top: 20px;">
      <button type="submit">Generate & Download</button>
      <p id="warn" class="danger"></p>
    </div>
  </form>

  <script src="/static/script.js"></script>
</body>
</html>
